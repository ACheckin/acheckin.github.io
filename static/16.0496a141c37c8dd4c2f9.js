(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{1154:function(e,a,t){"use strict";t.d(a,"a",(function(){return p}));t(146);var r=t(33),s=t.n(r),o=t(6),l=t.n(o),i=t(1126),n=t(1124);function c(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}class p extends l.a.PureComponent{render(){return l.a.createElement("div",{id:"back_button",className:"signup-header"},l.a.createElement(n.a,{onClick:this.props.onClick,to:this.props.url},l.a.createElement(i.a,{id:"generic_icons.back",defaultMessage:"Back Icon"},e=>l.a.createElement("span",{id:"back_button_icon",className:"fa fa-1x fa-angle-left",title:e.toString()})),l.a.createElement(i.a,{id:"web.header.back",defaultMessage:"Back"})))}}c(p,"propTypes",{url:s.a.string,onClick:s.a.func}),c(p,"defaultProps",{url:"/"})},1165:function(e,a,t){e.exports=t.p+"files/67504a826caf7430e472b4240bb534d7.png"},1972:function(e,a,t){"use strict";t.r(a);var r=t(322),s=t(7),o=t(19),l=t(15),i=t(14),n=(t(145),t(177),t(34),t(607),t(33)),c=t.n(n),p=t(6),m=t.n(p),d=t(1125),u=t(1165),h=t.n(u),f=t(1154),w=t(1126),E=t(1145),b=t(0),g=t(27),_=t(1147);function v(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}class P extends m.a.PureComponent{constructor(e){super(e),v(this,"submit",e=>{e.preventDefault();const a={},t=this.passwordInput.current.value;if(!t)return a.error=i.fb("claim.oauth_to_email.enterPwd","Please enter a password."),void this.setState(a);const{valid:r,error:s}=i.cb(t,this.props.passwordConfig);if(!r&&s)return void this.setState({error:s});const o=this.passwordConfirmInput.current.value;if(!o||t!==o)return a.error=i.fb("claim.oauth_to_email.pwdNotMatch","Passwords do not match."),void this.setState(a);a.error=null,this.setState(a),Object(E.w)(this.props.currentType,this.props.email,t,e=>{e.follow_link&&(window.location.href=e.follow_link)},e=>{this.setState({error:e.message})})}),this.state={},this.passwordInput=m.a.createRef(),this.passwordConfirmInput=m.a.createRef()}render(){var e=null;this.state.error&&(e=m.a.createElement("div",{className:"form-group has-error"},m.a.createElement("label",{className:"control-label"},this.state.error)));var a="form-group";e&&(a+=" has-error");const t="".concat(this.props.currentType===b.P.SAML_SERVICE?b.P.SAML_SERVICE.toUpperCase():i.pb(this.props.currentType)," SSO");return m.a.createElement("div",null,m.a.createElement("h3",null,m.a.createElement(w.a,{id:"claim.oauth_to_email.title",defaultMessage:"Switch {type} Account to Email",values:{type:t}})),m.a.createElement("form",{onSubmit:this.submit},m.a.createElement("p",null,m.a.createElement(w.a,{id:"claim.oauth_to_email.description",defaultMessage:"Upon changing your account type, you will only be able to login with your email and password."})),m.a.createElement("p",null,m.a.createElement(w.a,{id:"claim.oauth_to_email.enterNewPwd",defaultMessage:"Enter a new password for your {site} email account",values:{site:this.props.siteName}})),m.a.createElement("div",{className:a},m.a.createElement(_.a,{type:"password",className:"form-control",name:"password",ref:this.passwordInput,placeholder:{id:Object(g.b)("claim.oauth_to_email.newPwd"),defaultMessage:"New Password"},spellCheck:"false"})),m.a.createElement("div",{className:a},m.a.createElement(_.a,{type:"password",className:"form-control",name:"passwordconfirm",ref:this.passwordConfirmInput,placeholder:{id:Object(g.b)("claim.oauth_to_email.confirm"),defaultMessage:"Confirm Password"},spellCheck:"false"})),e,m.a.createElement("button",{type:"submit",className:"btn btn-primary"},m.a.createElement(w.a,{id:"claim.oauth_to_email.switchTo",defaultMessage:"Switch {type} to Email and Password",values:{type:t}}))))}}v(P,"propTypes",{currentType:c.a.string,email:c.a.string,siteName:c.a.string,passwordConfig:c.a.object});t(63),t(74);var y=t(1179);function N(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}class S extends m.a.PureComponent{constructor(e){super(e),N(this,"handleChange",e=>{e.preventDefault();const a=e.target.value.trim().replace(/\s/g,"");a!==this.state.token&&this.setState({token:a})}),N(this,"handleSubmit",e=>{e.preventDefault();const a={serverError:"",saving:!0};this.setState(a),this.props.submit(this.props.loginId,this.props.password,this.state.token)}),this.state={saving:!1,token:"",serverError:""}}render(){let e,a="";return this.state.serverError&&(e=m.a.createElement("label",{className:"control-label"},this.state.serverError),a=" has-error"),m.a.createElement("form",{onSubmit:this.handleSubmit},m.a.createElement("div",{className:"signup__email-container"},m.a.createElement("p",null,m.a.createElement(w.a,{id:"login_mfa.enterToken",defaultMessage:"To complete the sign in process, please enter a token from your smartphone's authenticator"})),m.a.createElement("div",{className:"form-group"+a},e),m.a.createElement("div",{className:"form-group"+a},m.a.createElement(_.a,{type:"text",className:"form-control",name:"token",placeholder:{id:Object(g.b)("login_mfa.token"),defaultMessage:"MFA Token"},spellCheck:"false",autoComplete:"off",autoFocus:!0,onChange:this.handleChange})),m.a.createElement("div",{className:"form-group"},m.a.createElement(y.a,{saving:this.state.saving,disabled:this.state.saving,onClick:this.handleSubmit,defaultMessage:Object(i.fb)("login_mfa.submit","Submit"),savingMessage:Object(i.fb)("login_mfa.submitting","Submitting...")}))))}}function M(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}N(S,"propTypes",{loginId:c.a.string.isRequired,password:c.a.string.isRequired,submit:c.a.func.isRequired});class C extends m.a.PureComponent{constructor(e){super(e),M(this,"preSubmit",e=>{e.preventDefault();var a={},t=this.passwordInput.current.value;if(!t)return a.error=i.fb("claim.email_to_oauth.pwdError","Please enter your password."),void this.setState(a);this.setState({password:t}),a.error=null,this.setState(a),this.submit(this.props.email,t,"")}),M(this,"submit",(e,a,t)=>{Object(E.k)(e,a,t,this.props.newType,e=>{e.follow_link&&(window.location.href=e.follow_link)},e=>{this.state.showMfa||"mfa.validate_token.authenticate.app_error"!==e.server_error_id?this.setState({error:e.message,showMfa:!1}):this.setState({showMfa:!0})})}),this.state={showMfa:!1,password:""},this.passwordInput=m.a.createRef()}render(){var e=null;this.state.error&&(e=m.a.createElement("div",{className:"form-group has-error"},m.a.createElement("label",{className:"control-label"},this.state.error)));var a="form-group";e&&(a+=" has-error");const t=this.props.newType===b.P.SAML_SERVICE?b.P.SAML_SERVICE.toUpperCase():i.pb(this.props.newType),r="".concat(t," SSO");let s;return s=this.state.showMfa?m.a.createElement(S,{loginId:this.props.email,password:this.state.password,submit:this.submit}):m.a.createElement("form",{onSubmit:this.preSubmit},m.a.createElement("p",null,m.a.createElement(w.a,{id:"claim.email_to_oauth.ssoType",defaultMessage:"Upon claiming your account, you will only be able to login with {type} SSO",values:{type:t}})),m.a.createElement("p",null,m.a.createElement(w.a,{id:"claim.email_to_oauth.ssoNote",defaultMessage:"You must already have a valid {type} account",values:{type:t}})),m.a.createElement("p",null,m.a.createElement(w.a,{id:"claim.email_to_oauth.enterPwd",defaultMessage:"Enter the password for your {site} account",values:{site:this.props.siteName}})),m.a.createElement("div",{className:a},m.a.createElement(_.a,{type:"password",className:"form-control",name:"password",ref:this.passwordInput,placeholder:{id:Object(g.b)("claim.email_to_oauth.pwd"),defaultMessage:"Password"},spellCheck:"false"})),e,m.a.createElement("button",{type:"submit",className:"btn btn-primary"},m.a.createElement(w.a,{id:"claim.email_to_oauth.switchTo",defaultMessage:"Switch Account to {uiType}",values:{uiType:r}}))),m.a.createElement("div",null,m.a.createElement("h3",null,m.a.createElement(w.a,{id:"claim.email_to_oauth.title",defaultMessage:"Switch Email/Password Account to {uiType}",values:{uiType:r}})),s)}}M(C,"propTypes",{newType:c.a.string,email:c.a.string,siteName:c.a.string});t(101);function I(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}class k extends m.a.Component{constructor(e){super(e),I(this,"preSubmit",e=>{e.preventDefault();var a={passwordError:"",confirmError:"",ldapPasswordError:"",serverError:""};const t=this.ldapPasswordInput.current.value;if(!t)return a.ldapPasswordError=i.fb("claim.ldap_to_email.ldapPasswordError","Please enter your AD/LDAP password."),void this.setState(a);const r=this.passwordInput.current.value;if(!r)return a.passwordError=i.fb("claim.ldap_to_email.pwdError","Please enter your password."),void this.setState(a);const{valid:s,error:o}=i.cb(r,this.props.passwordConfig);if(!s&&o)return void this.setState({passwordError:o});const l=this.passwordConfirmInput.current.value;if(!l||r!==l)return a.confirmError=i.fb("claim.ldap_to_email.pwdNotMatch","Passwords do not match."),void this.setState(a);a.password=r,a.ldapPassword=t,this.setState(a),this.submit(this.props.email,r,"",t)}),I(this,"submit",(e,a,t,r)=>{this.props.switchLdapToEmail(r||this.state.ldapPassword,this.props.email,a,t).then(({data:e,error:a})=>{e&&e.follow_link?window.location.href=e.follow_link:a&&(a.server_error_id.startsWith("model.user.is_valid.pwd")?this.setState({passwordError:a.message,showMfa:!1}):"ent.ldap.do_login.invalid_password.app_error"===a.server_error_id?this.setState({ldapPasswordError:a.message,showMfa:!1}):this.state.showMfa||"mfa.validate_token.authenticate.app_error"!==a.server_error_id?this.setState({serverError:a.message,showMfa:!1}):this.setState({showMfa:!0}))})}),this.state={passwordError:"",confirmError:"",ldapPasswordError:"",serverError:""},this.ldapPasswordInput=m.a.createRef(),this.passwordInput=m.a.createRef(),this.passwordConfirmInput=m.a.createRef()}render(){let e=null,a="form-group";this.state.serverError&&(e=m.a.createElement("div",{className:"form-group has-error"},m.a.createElement("label",{className:"control-label"},this.state.serverError)),a+=" has-error");let t=null,r="form-group";this.state.passwordError&&(t=m.a.createElement("div",{className:"form-group has-error"},m.a.createElement("label",{className:"control-label"},this.state.passwordError)),r+=" has-error");let s=null,o="form-group";this.state.ldapPasswordError&&(s=m.a.createElement("div",{className:"form-group has-error"},m.a.createElement("label",{className:"control-label"},this.state.ldapPasswordError)),o+=" has-error");let l=null,n="form-group";this.state.confirmError&&(l=m.a.createElement("div",{className:"form-group has-error"},m.a.createElement("label",{className:"control-label"},this.state.confirmError)),n+=" has-error");const c=i.fb("claim.ldap_to_email.ldapPwd","AD/LDAP Password");let p;return p=this.state.showMfa?m.a.createElement(S,{loginId:this.props.email,password:this.state.password,submit:this.submit}):m.a.createElement("form",{onSubmit:this.preSubmit,className:a},m.a.createElement("p",null,m.a.createElement(w.a,{id:"claim.ldap_to_email.email",defaultMessage:"After switching your authentication method, you will use {email} to login. Your AD/LDAP credentials will no longer allow access to Mattermost.",values:{email:this.props.email}})),m.a.createElement("p",null,m.a.createElement(w.a,{id:"claim.ldap_to_email.enterLdapPwd",defaultMessage:"{ldapPassword}:",values:{ldapPassword:c}})),m.a.createElement("div",{className:o},m.a.createElement("input",{type:"password",className:"form-control",name:"ldapPassword",ref:this.ldapPasswordInput,placeholder:c,spellCheck:"false"})),s,m.a.createElement("p",null,m.a.createElement(w.a,{id:"claim.ldap_to_email.enterPwd",defaultMessage:"New email login password:"})),m.a.createElement("div",{className:r},m.a.createElement(_.a,{type:"password",className:"form-control",name:"password",ref:this.passwordInput,placeholder:{id:Object(g.b)("claim.ldap_to_email.pwd"),defaultMessage:"Password"},spellCheck:"false"})),t,m.a.createElement("div",{className:n},m.a.createElement(_.a,{type:"password",className:"form-control",name:"passwordconfirm",ref:this.passwordConfirmInput,placeholder:{id:Object(g.b)("claim.ldap_to_email.confirm"),defaultMessage:"Confirm Password"},spellCheck:"false"})),l,m.a.createElement("button",{type:"submit",className:"btn btn-primary"},m.a.createElement(w.a,{id:"claim.ldap_to_email.switchTo",defaultMessage:"Switch account to email/password"})),e),m.a.createElement("div",null,m.a.createElement("h3",null,m.a.createElement(w.a,{id:"claim.ldap_to_email.title",defaultMessage:"Switch AD/LDAP Account to Email/Password"})),p)}}function A(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}I(k,"propTypes",{email:c.a.string,passwordConfig:c.a.object,switchLdapToEmail:c.a.func.isRequired});class L extends m.a.Component{constructor(e){super(e),A(this,"preSubmit",e=>{e.preventDefault();var a={passwordError:"",ldapError:"",ldapPasswordError:"",serverError:""};const t=this.emailPasswordInput.current&&this.emailPasswordInput.current.value;if(!t)return a.passwordError=i.fb("claim.email_to_ldap.pwdError","Please enter your password."),void this.setState(a);const r=this.ldapIdInput.current&&this.ldapIdInput.current.value.trim();if(!r)return a.ldapError=i.fb("claim.email_to_ldap.ldapIdError","Please enter your AD/LDAP ID."),void this.setState(a);const s=this.ldapPasswordInput.current&&this.ldapPasswordInput.current.value;if(!s)return a.ldapPasswordError=i.fb("claim.email_to_ldap.ldapPasswordError","Please enter your AD/LDAP password."),void this.setState(a);a.password=t,a.ldapId=r,a.ldapPassword=s,this.setState(a),this.submit(this.props.email,t,"",r,s)}),A(this,"submit",(e,a,t,r,s)=>{Object(E.j)(e,a,t,r||this.state.ldapId,s||this.state.ldapPassword,e=>{e.follow_link&&(window.location.href=e.follow_link)},e=>{if(this.state.showMfa||"mfa.validate_token.authenticate.app_error"!==e.server_error_id)switch(e.id){case"ent.ldap.do_login.user_not_registered.app_error":case"ent.ldap.do_login.user_filtered.app_error":case"ent.ldap.do_login.matched_to_many_users.app_error":this.setState({ldapError:e.message,showMfa:!1});break;case"ent.ldap.do_login.invalid_password.app_error":this.setState({ldapPasswordError:e.message,showMfa:!1});break;case"api.user.check_user_password.invalid.app_error":this.setState({passwordError:e.message,showMfa:!1});break;default:this.setState({serverError:e.message,showMfa:!1})}else this.setState({showMfa:!0})})}),this.state={passwordError:"",ldapError:"",ldapPasswordError:"",serverError:"",showMfa:!1},this.emailPasswordInput=m.a.createRef(),this.ldapIdInput=m.a.createRef(),this.ldapPasswordInput=m.a.createRef()}render(){let e=null,a="form-group";this.state.serverError&&(e=m.a.createElement("div",{className:"form-group has-error"},m.a.createElement("label",{className:"control-label"},this.state.serverError)),a+=" has-error");let t=null,r="form-group";this.state.passwordError&&(t=m.a.createElement("div",{className:"form-group has-error"},m.a.createElement("label",{className:"control-label"},this.state.passwordError)),r+=" has-error");let s=null,o="form-group";this.state.ldapError&&(s=m.a.createElement("div",{className:"form-group has-error"},m.a.createElement("label",{className:"control-label"},this.state.ldapError)),o+=" has-error");let l,n,c=null,p="form-group";return this.state.ldapPasswordError&&(c=m.a.createElement("div",{className:"form-group has-error"},m.a.createElement("label",{className:"control-label"},this.state.ldapPasswordError)),p+=" has-error"),l=this.props.ldapLoginFieldName?this.props.ldapLoginFieldName:i.fb("claim.email_to_ldap.ldapId","AD/LDAP ID"),n=this.state.showMfa?m.a.createElement(S,{loginId:this.props.email,password:this.state.password,submit:this.submit}):m.a.createElement("form",{onSubmit:this.preSubmit,className:a},m.a.createElement("p",null,m.a.createElement(w.a,{id:"claim.email_to_ldap.ssoType",defaultMessage:"Upon claiming your account, you will only be able to login with AD/LDAP"})),m.a.createElement("p",null,m.a.createElement(w.a,{id:"claim.email_to_ldap.ssoNote",defaultMessage:"You must already have a valid AD/LDAP account"})),m.a.createElement("p",null,m.a.createElement(w.a,{id:"claim.email_to_ldap.enterPwd",defaultMessage:"Enter the password for your {site} email account",values:{site:this.props.siteName}})),m.a.createElement("input",{type:"text",style:T.usernameInput,name:"fakeusernameremembered"}),m.a.createElement("div",{className:r},m.a.createElement(_.a,{type:"password",className:"form-control",name:"emailPassword",ref:this.emailPasswordInput,autoComplete:"off",placeholder:{id:Object(g.b)("claim.email_to_ldap.pwd"),defaultMessage:"Password"},spellCheck:"false"})),t,m.a.createElement("p",null,m.a.createElement(w.a,{id:"claim.email_to_ldap.enterLdapPwd",defaultMessage:"Enter the ID and password for your AD/LDAP account"})),m.a.createElement("div",{className:o},m.a.createElement("input",{type:"text",className:"form-control",name:"ldapId",ref:this.ldapIdInput,autoComplete:"off",placeholder:l,spellCheck:"false"})),s,m.a.createElement("div",{className:p},m.a.createElement(_.a,{type:"password",className:"form-control",name:"ldapPassword",ref:this.ldapPasswordInput,autoComplete:"off",placeholder:{id:Object(g.b)("claim.email_to_ldap.ldapPwd"),defaultMessage:"AD/LDAP Password"},spellCheck:"false"})),c,m.a.createElement("button",{type:"submit",className:"btn btn-primary"},m.a.createElement(w.a,{id:"claim.email_to_ldap.switchTo",defaultMessage:"Switch Account to AD/LDAP"})),e),m.a.createElement("div",null,m.a.createElement("h3",null,m.a.createElement(w.a,{id:"claim.email_to_ldap.title",defaultMessage:"Switch Email/Password Account to AD/LDAP"})),n)}}A(L,"propTypes",{email:c.a.string,siteName:c.a.string,ldapLoginFieldName:c.a.string});const T={usernameInput:{display:"none"}};class D extends m.a.PureComponent{render(){const e=new URLSearchParams(this.props.location.search).get("email"),a=new URLSearchParams(this.props.location.search).get("new_type"),t=new URLSearchParams(this.props.location.search).get("old_type");return m.a.createElement("div",null,m.a.createElement(f.a,null),m.a.createElement("div",{className:"col-sm-12"},m.a.createElement("div",{className:"signup-team__container"},m.a.createElement("img",{alt:"signup logo",className:"signup-team-logo",src:h.a}),m.a.createElement("div",{id:"claim"},m.a.createElement(d.d,null,m.a.createElement(d.b,{path:"".concat(this.props.match.url,"/oauth_to_email"),render:()=>m.a.createElement(P,{currentType:t,email:e,siteName:this.props.siteName,passwordConfig:this.props.passwordConfig})}),m.a.createElement(d.b,{path:"".concat(this.props.match.url,"/email_to_oauth"),render:()=>m.a.createElement(C,{newType:a,email:e,siteName:this.props.siteName})}),m.a.createElement(d.b,{path:"".concat(this.props.match.url,"/ldap_to_email"),render:()=>m.a.createElement(k,{email:e,passwordConfig:this.props.passwordConfig,switchLdapToEmail:this.props.actions.switchLdapToEmail})}),m.a.createElement(d.b,{path:"".concat(this.props.match.url,"/email_to_ldap"),render:()=>m.a.createElement(L,{email:e,siteName:this.props.siteName,ldapLoginFieldName:this.props.ldapLoginFieldName})}))))))}}var j,O,R;j=D,O="propTypes",R={location:c.a.object.isRequired,siteName:c.a.string,ldapLoginFieldName:c.a.string,passwordConfig:c.a.object,match:c.a.shape({url:c.a.string.isRequired}).isRequired,actions:c.a.shape({switchLdapToEmail:c.a.func.isRequired}).isRequired},O in j?Object.defineProperty(j,O,{value:R,enumerable:!0,configurable:!0,writable:!0}):j[O]=R;a.default=Object(r.connect)((function(e){const a=Object(l.getConfig)(e);return{siteName:a.SiteName,ldapLoginFieldName:a.LdapLoginFieldName,passwordConfig:Object(i.C)(a)}}),(function(e){return{actions:Object(s.bindActionCreators)({switchLdapToEmail:o.switchLdapToEmail},e)}}))(D)}}]);
//# sourceMappingURL=16.0496a141c37c8dd4c2f9.js.map